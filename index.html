<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini IPTV - Local</title>
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <style>
        :root { --primary: #ffc107; --bg: #000; }
        body { background: var(--bg); color: white; font-family: sans-serif; margin: 0; text-align: center; }
        .app-container { max-width: 500px; margin: 0 auto; }
        .player-section { position: sticky; top: 0; z-index: 1000; background: #000; border-bottom: 2px solid #1a1a1a; }
        .setup-bar { padding: 15px; display: flex; flex-direction: column; gap: 10px; background: #111; }
        .btn-file { background: #333; color: var(--primary); border: 2px dashed var(--primary); padding: 15px; border-radius: 8px; font-weight: bold; cursor: pointer; display: block; }
        #status { color: var(--primary); padding: 10px; font-weight: bold; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; }
        .card { background: #111; border-radius: 10px; padding: 12px 5px; border: 1px solid #222; font-size: 10px; min-height: 50px; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div class="app-container">
        <div class="player-section">
            <video id="main-player" class="video-js vjs-16-9 vjs-big-play-centered" controls playsinline></video>
        </div>

        <div class="setup-bar">
            <label class="btn-file">
                üìÅ CLIQUE AQUI PARA CARREGAR O ARQUIVO M3U
                <input type="file" id="input-m3u" accept=".m3u,.php,.txt" style="display: none;" onchange="lerArquivo(this)">
            </label>
            <div id="status">Selecione a lista baixada</div>
        </div>

        <main id="channel-list" class="grid"></main>
    </div>

    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <script>
        const player = videojs('main-player');

        function lerArquivo(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            document.getElementById('status').innerText = "Processando arquivo...";
            
            reader.onload = function(e) {
                const conteudo = e.target.result;
                const linhas = conteudo.split('\n');
                const canais = [];
                
                for (let i = 0; i < linhas.length; i++) {
                    if (linhas[i].includes('#EXTINF:')) {
                        const nome = linhas[i].split(',').pop().trim();
                        let link = linhas[i+1]?.trim();
                        if(link && link.startsWith('http')) {
                            canais.push({ nome, url: link });
                        }
                    }
                }
                
                exibirCanais(canais);
            };
            reader.readAsText(file);
        }

        function exibirCanais(lista) {
            const container = document.getElementById('channel-list');
            container.innerHTML = "";
            document.getElementById('status').innerText = lista.length + " Canais Carregados!";
            
            lista.forEach(c => {
                const div = document.createElement('div');
                div.className = 'card';
                div.innerText = c.nome;
                div.onclick = () => {
                    player.src({ src: c.url, type: 'application/x-mpegURL' });
                    player.play();
                    window.scrollTo({top: 0, behavior: 'smooth'});
                };
                container.appendChild(div);
            });
        }
    </script>
</body>
</html>
